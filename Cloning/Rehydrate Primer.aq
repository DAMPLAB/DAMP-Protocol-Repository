{"config":{"title":"Rehydrate Primer","description":"No description given","copyright":"No copyright declared","version":"no version info","authors":[],"maintainer":{"name":"No maintainer","email":"noone@nowehere"},"acknowledgements":[],"github":{"repo":"none","user":"none","access_token":"none"},"keywords":[],"aquadoc_version":"1.0.0"},"components":[{"sample_types":[{"id":1,"name":"Primer","description":"The primer stock solutions are diluted to 25 uM. Primer melting temperatures should be calculated using the **NEB Tm calculator http://tmcalculator.neb.com/#!/main configured for Phusion High-Fidelity DNA Polymerase (HF Buffer)** for standard PCR reaction","created_at":"2013-10-08T10:18:01.000-07:00","updated_at":"2018-02-25T04:40:37.000-08:00","field_types":[{"id":1,"parent_id":1,"name":"Overhang Sequence","ftype":"string","choices":null,"array":false,"required":false,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2,"parent_id":1,"name":"Anneal Sequence","ftype":"string","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":3,"parent_id":1,"name":"T Anneal","ftype":"number","choices":null,"array":false,"required":true,"created_at":"2016-05-09T20:40:31.000-07:00","updated_at":"2016-05-09T21:25:11.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]},{"id":2207,"parent_id":1,"name":"URL","ftype":"url","choices":null,"array":false,"required":false,"created_at":"2017-07-24T14:21:24.000-07:00","updated_at":"2017-07-24T14:21:24.000-07:00","parent_class":"SampleType","role":null,"part":null,"routing":null,"preferred_operation_type_id":null,"preferred_field_type_id":null,"allowable_field_types":[],"sample_types":[],"object_types":[]}]}],"object_types":[{"id":513,"name":"Lyophilized Primer","description":"White powder, usually not visible","min":1,"max":10000,"handler":"sample_container","safety":"","cleanup":"","data":"{\r\n\"opentrons_labware\": \"24-well-1.5ml-rack\"\r\n}","vendor":"","created_at":"2016-11-08T15:08:30.000-08:00","updated_at":"2018-09-04T19:56:57.000-07:00","unit":"tube","cost":5.0,"release_method":"return","release_description":"","sample_type_id":1,"image":"","prefix":"","rows":null,"columns":null,"sample_type_name":"Primer"},{"id":322,"name":"Primer Stock","description":"Rehydrated primer in tube from IDT - 100uM","min":0,"max":1,"handler":"sample_container","safety":"No safety information","cleanup":"No cleanup information","data":"{ \"min_conc\": 0.000010, \"rec_conc\": 0.000025, \"max_vol\": 1500, \"conc_callback\": \"manually_enter_uM_conc\", \"short_description\":\"1.5 mL tube\", \"opentrons_labware\": \"24-well-1.5ml-rack\"}","vendor":"No vendor information","created_at":"2014-01-22T16:56:36.000-08:00","updated_at":"2018-09-04T19:56:25.000-07:00","unit":"Base","cost":0.26,"release_method":"return","release_description":"","sample_type_id":1,"image":"","prefix":"M20O","rows":null,"columns":null,"sample_type_name":"Primer"}],"operation_type":{"name":"Rehydrate Primer","category":"Cloning","deployed":false,"on_the_fly":false,"field_types":[{"ftype":"sample","role":"input","name":"Primer","sample_types":["Primer"],"object_types":["Lyophilized Primer"],"part":false,"array":false,"routing":"PR","preferred_operation_type_id":328,"preferred_field_type_id":1811,"choices":null},{"ftype":"sample","role":"output","name":"Primer Stock","sample_types":["Primer"],"object_types":["Primer Stock"],"part":false,"array":false,"routing":"PR","preferred_operation_type_id":null,"preferred_field_type_id":null,"choices":null}],"protocol":"needs \"Cloning Libs/Cloning\"\r\nneeds \"Standard Libs/Debug Lib\"\r\nneeds \"Cloning Libs/OpenTronsAq\"\r\n\r\nclass Protocol\r\n  include Cloning\r\n  include Debug\r\n  include OpenTronsAq\r\n  \r\n  #Item.extend(ItemMixin)\r\n  \r\n  def main\r\n    current_taken_items = []\r\n    output_volumes = {\"Primer Stock\" =\u003e 190}\r\n\r\n    operations.sort_by! {|op| op.input(\"Primer\").item.id}\r\n    \r\n    robust_make [\"Primer Stock\"], current_taken_items\r\n    \r\n    operations.each do |op|\r\n        op.input(\"Primer\").item.associate(:order_number, (Random.rand*10000).round).save\r\n    end if debug\r\n    \r\n    order_nums = operations.map{|op| op.input(\"Primer\").item.get(:order_number)}.uniq.to_sentence\r\n    \r\n    show do\r\n        title \"Find primers at bench\"\r\n        check \"Find primers #{operations.running.map{|op| op.input(\"Primer\").item}.to_sentence} on the bench (look for packages with order numbers: #{order_nums})\"\r\n    end\r\n    \r\n    robust_take_inputs [\"Primer\"], current_taken_items, interactive: false\r\n    \r\n    show do\r\n      title \"Enter the nmol of the primer\"\r\n      check \"Enter the amount of each primer supplied by IDT in nanomoles. This is written toward the bottom of the tube. The id of the primer is listed before the primer's name on the side of the tube.\"\r\n      table operations.start_table\r\n        .input_item(\"Primer\")\r\n        .get(:nmol, type: \"number\", heading: \"nmol\", default: 25)\r\n        .end_table\r\n      check \"Get out #{operations.running.count} new 1.5 ml tubes with the following IDs: #{(operations.map {|op| op.output(\"Primer Stock\").item.id}).to_sentence}\"\r\n    end\r\n    \r\n    ot2_choice = show do\r\n        title \"Select execution method\"\r\n        select [\"No\", \"Yes\"], var: \"ot2\", label: \"Is the OT2 robot available?\"\r\n    end\r\n    \r\n    if ot2_choice[:ot2] == \"Yes\"\r\n        \r\n        prot = OTAqProtocol.new\r\n        \r\n        prot.add_labware_definition('24-well-1.5ml-rack')\r\n        \r\n        water_container = prot.labware.load('point', '1', 'Water')\r\n        \r\n        water = prot.dummy_item \"DI Water\"\r\n        prot.assign_wells [water], [water_container.wells(0)]\r\n        \r\n        p300 = prot.instruments.P300_Single(mount: 'left', tip_model: \"tiprack-200ul\")\r\n        \r\n        prot.assign_wells operations.map{|op| op.input(\"Primer\").item}\r\n        \r\n        prot.assign_wells operations.map{|op| op.output(\"Primer Stock\").item}\r\n        \r\n        operations.each do |op|\r\n            p300.pick_up_tip\r\n            p300.aspirate(200, prot.find_well(water).bottom(1))\r\n            p300.dispense(200, prot.find_well(op.input(\"Primer\").item).bottom(1))\r\n            8.times do\r\n                p300.aspirate(150, prot.find_well(op.input(\"Primer\").item).bottom(2))\r\n                p300.dispense(150, prot.find_well(op.input(\"Primer\").item).bottom(2))\r\n            end\r\n            p300.aspirate(180, prot.find_well(op.input(\"Primer\").item).bottom(1))\r\n            p300.dispense(180, prot.find_well(op.output(\"Primer Stock\").item).bottom(1))\r\n            p300.drop_tip\r\n        end\r\n        \r\n        operations.each do |op|\r\n            target_vol = (op.output(\"Primer Stock\").object_type.data_object[:rec_conc] / (op.temporary[:nmol] / 200000.0)) * 180\r\n            vol_to_add = ([target_vol, 1400].min - 180).to_i\r\n            p300.pick_up_tip\r\n            (vol_to_add / 200).times do\r\n                p300.aspirate(200, prot.find_well(water).bottom(1))\r\n                p300.dispense(200, prot.find_well(op.output(\"Primer Stock\").item).top(0))\r\n            end\r\n            p300.aspirate(vol_to_add % 200, prot.find_well(water).bottom(1))\r\n            p300.dispense(vol_to_add % 200, prot.find_well(op.output(\"Primer Stock\").item).top(0))\r\n            p300.drop_tip\r\n        end\r\n        \r\n        run_protocol prot\r\n        \r\n        show do\r\n            title \"Clean up\"\r\n            check \"Discard empty original tubes.\"\r\n            check \"Cap all 1.5 mL tubes.\"\r\n        end\r\n        \r\n        operations.running.each do |op|\r\n            op.output(\"Primer Stock\").item.associate :concentration, op.output(\"Primer Stock\").object_type.data_object[:rec_conc]\r\n            #op.output(\"Primer Stock\").item.associate :volum, output_volumes[\"Primer Stock\"]\r\n            op.output(\"Primer Stock\").item.save\r\n            op.input(\"Primer\").item.mark_as_deleted\r\n        end\r\n        \r\n    else\r\n        \r\n        show do\r\n          title \"Add water and mix\"\r\n          warning \"Be sure to spin down the primer tubes before opening!\"\r\n          check \"Add 200 µl of water to all primer tubes.\"\r\n          check \"Wait one minute for the primer to dissolve.\"\r\n          check \"Vortex tubes for 2 seconds.\"\r\n          check \"Spin down tubes for 2 seconds\"\r\n        end\r\n        \r\n        show do\r\n            title \"Transfer to new tubes\"\r\n            note \"Transfer diluted primers to #{operations.running.count} new 1.5 ml tubes with the following IDs:\"\r\n            table operations.start_table\r\n            .output_item(\"Primer Stock\")\r\n            .custom_column(heading: \"Original primer tube from IDT\") { |op| {content: \"190 µl of #{op.input(\"Primer\").item.id}\", check: true}}\r\n            .end_table\r\n        end\r\n        \r\n        operations.running.each do |op|\r\n            op.output(\"Primer Stock\").item.associate :concentration, op.temporary[:nmol]/200000.0\r\n            #op.output(\"Primer Stock\").item.associate :volum, output_volumes[\"Primer Stock\"]\r\n            op.output(\"Primer Stock\").item.save\r\n            op.input(\"Primer\").item.mark_as_deleted\r\n        end\r\n        \r\n        #items_to_dilute = operations.running.map{|op| op.output(\"Primer Stock\").item}\r\n    end\r\n    \r\n    #show do\r\n    #    title \"Dilute the following items\"\r\n    #    check \"Dilute items according to the following table:\"\r\n    #    table_matrix = Array.new(items_to_dilute.count+1) {Array.new}\r\n    #    table_matrix[0] = [\"Item ID\", \"Water to add\"]\r\n    #    items_to_dilute.each_with_index do |item, item_index|\r\n    #        dilution_factor = item.get(:concentration).to_f / item.object_type.data_object[:rec_conc].to_f\r\n    #        volume_to_add = ((dilution_factor - 1.0)*item.get(:raw_volume).to_f).round(2)\r\n    #        new_volume = ((item.get(:raw_volume).to_f+volume_to_add)*0.95-2.0).round(2)\r\n    #        item.associate(:volume, new_volume)\r\n    #        item.associate(:raw_volume, nil)\r\n    #        item.associate(:concentration, item.object_type.data_object[:rec_conc].to_f)\r\n    #        item.associate(:concentration_keyword, \"STANDARD\")\r\n    #        item.save\r\n    #        table_matrix[item_index+1] = [item.id.to_s, {content: \"#{volume_to_add} µl of water\", check: true}]\r\n    #    end\r\n    #    table table_matrix\r\n    #end\r\n    \r\n    \r\n    #operations.running.store io: \"output\", interactive: true\r\n    \r\n    store_outputs_with_volumes output_volumes, current_taken_items, interactive: true\r\n    \r\n    return {}\r\n    \r\n  end\r\n\r\nend","precondition":"def precondition(op)\n  true\nend","cost_model":"# All related numbers come from 'Damp Lab Services_Dec2019'\n# materials are calculated on 'Damp Lab Services_Dec2019'\n# l stands for labor\n\ndef cost(op)\n    l = 28.75 * Parameter.get_float('labor rate (min)')\n    {labor: 0, materials: l }\nend","documentation":"This should always be run after \u003cb\u003eOrder Primer\u003c/b\u003e to convert the lyophilizedprimer item (received from IDT) into a primer stock (which can be used in other operations).\u003cbr\u003e\u003cbr\u003e\n\n------\u003cb\u003eOutput Volume(s)\u003c/b\u003e------\u003cbr\u003e\nPrimer Stock -\u003e ~1000 µl","test":"","timing":null}}]}